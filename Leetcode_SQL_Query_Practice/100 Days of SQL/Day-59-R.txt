CREATE TABLE cinema (
    seat_id INT PRIMARY KEY,
    free int
);
delete from cinema;
INSERT INTO cinema (seat_id, free) VALUES (1, 1);
INSERT INTO cinema (seat_id, free) VALUES (2, 0);
INSERT INTO cinema (seat_id, free) VALUES (3, 1);
INSERT INTO cinema (seat_id, free) VALUES (4, 1);
INSERT INTO cinema (seat_id, free) VALUES (5, 1);
INSERT INTO cinema (seat_id, free) VALUES (6, 0);
INSERT INTO cinema (seat_id, free) VALUES (7, 1);
INSERT INTO cinema (seat_id, free) VALUES (8, 1);
INSERT INTO cinema (seat_id, free) VALUES (9, 0);
INSERT INTO cinema (seat_id, free) VALUES (10, 1);
INSERT INTO cinema (seat_id, free) VALUES (11, 0);
INSERT INTO cinema (seat_id, free) VALUES (12, 1);
INSERT INTO cinema (seat_id, free) VALUES (13, 0);
INSERT INTO cinema (seat_id, free) VALUES (14, 1);
INSERT INTO cinema (seat_id, free) VALUES (15, 1);
INSERT INTO cinema (seat_id, free) VALUES (16, 0);
INSERT INTO cinema (seat_id, free) VALUES (17, 1);
INSERT INTO cinema (seat_id, free) VALUES (18, 1);
INSERT INTO cinema (seat_id, free) VALUES (19, 1);
INSERT INTO cinema (seat_id, free) VALUES (20, 1);

select * from cinema;

-- Method 1 with Row_number logic
with cte2 as
(
select *,row_number() over(order by seat_id) as rn, seat_id-row_number() over(order by seat_id) as grp from cinema where free=1
),
cte3 as
(
select *,count(*) over(partition by grp) as cnt from cte2
)
select * from cte3 where cnt>1;


-- Method 2 self join

with cte as
(
select a.seat_id as seat_id_a,b.seat_id as seat_id_b from cinema a
inner join cinema b 
on a.seat_id = b.seat_id+1
where a.free=1 and b.free=1
)
select distinct seat_id_a as seat_id
from cte
union
select distinct seat_id_b as seat_id 
from cte
order by seat_id


-- Method three lag and lead. 

Take lead, lag columns of seat_id,
if lead=1 or lag = 1 or lead=1 and lag=1 then the seat_id falls under a consecutive seat_id