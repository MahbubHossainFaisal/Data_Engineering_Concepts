-- Create orders table (fixed trailing comma)
create table orders (
  order_id int,
  customer_id int,
  product_id int
);

-- Insert data into orders
insert into orders VALUES 
(1, 1, 1),
(1, 1, 2),
(1, 1, 3),
(2, 2, 1),
(2, 2, 2),
(2, 2, 4),
(3, 1, 5);

-- Create products table
create table products (
  id int,
  name varchar(10)
);

-- Insert data into products
insert into products VALUES 
(1, 'A'),
(2, 'B'),
(3, 'C'),
(4, 'D'),
(5, 'E');

select * from orders;
select * from products;

with product_pair as
(
select
c.name || ' ' || d.name as pair, count(1) as purchase_freq
from orders a 
inner join orders b 
on a.order_id = b.order_id and a.customer_id = b.customer_id and a.product_id <> b.product_id
and a.product_id < b.product_id
inner join products c 
on a.product_id = c.id
inner join products d 
on b.product_id = d.id
group by c.name,d.name
)
select * from product_pair;