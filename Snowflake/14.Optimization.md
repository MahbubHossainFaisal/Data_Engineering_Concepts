- Optimizing Performance in Snowflake

- Functioning of Snowflake
    - Irrespective of query complexity, cost is proportional to Data Size
    - You are not paying snowflake for the query execution but for the uptime of the warehouse.
    - You may need to download more data than required from remote storage in the micro partitions in order
    to fullfill the demand of a query!
    - As data volume grows, More micro partitions would be created and VWH would need more processing time to process for a query. As a result, cost will also increase.
    - The problem arises of DWH computing unnecessary micro partitions is because it the data in the remote storage
    is not ordered.
    - That's why Snowflake comes with Clustering
    - But in order to do clustering also, Snowflake will charge and it will cost us.
    - The manual way to resolve this would be, while inserting data into the table you have to order by with the columns that are being used the most while querying on that table.

- Scale Up VS Scale Out
    - Scale Up
        - When data volume is huge and one query is taking really really long time to process, in that case we need
        to Scale up our VWH to a longer size.
        - So Scale up is proportional to data volume
    - Scale Out
        - When data volume is normal but more number of people are using the same DWH and running concurrent queries
        in the same table, in that case Snowflake end up queueing queries under the same DWH which makes user get slower response. In that we can use multicluster to scale out DWH in order to reduce queuing queries up.

- How to optimize query

    - First we have to lool for some primary checks
        - Checking how complex it is 
        - Is there any unnecessary joins or aggregation
        - In query profile, which steps is taking a longer time 
        - Join keys might have duplicate records
        - Cartesian joins
        - [Other most important issues for a query to work slow]
    - After that, we can focus on the areas that need to be fixed or if there is no issue, then
    we can think about scale up or scale out approach.

- Storage consideration
    - Automatic clustering
    - Search Optimization Service
    - Materialized Views

These options will make data better organized in the Remote storage and that will help write micropartitions orderly manner and reduce the query processing time. (I didn't understand one thing, When we use these storage techniques, where data gets ordered/changed -> in Remote storage layer or in Micro partition layer?)


- Provide any important missing concepts from Snowflake Docs which may not mentioned above.

- How Snowflake generates Revenue?
    - Provides compute resources
        - Serverless compute resources
            - Auto clustering, Cloud Services Layer, Snowpipe
    - Warehouses
        - Execute queries, Stored procedure etc.

But traditioanl cloud providers can provide it too. Then what is the difference in Snowflake?
    - Ans is Elasticity
    - To Scale out, Scale up , Spin up cluster -> These are the additional advantage Snowflake provides.
    - More uptime of these compute resources, More revenue for Snowflake
    - More volume of data -> More uptime of compute resources -> More revenue to Snowflake
    - In which scenario -> Snowflake will be in loss?
        - Hint : Optimizing Query engine performance!
    - As an informed user
        - Regulate your data at least in DEV and QA environments
        - Don't use GB or TB's of data while your development activities and testing Activities
        - Use Smaller Data Sample.
        - Plan your development and testing budgets before starting your project
        - Review the cost regularly
        - plan or monitor how much it cost to run your data pipelines when the code moves to PROD.

- Warehouse Monitor
    - We can limit credits usage for DWHs and monitor that in the monitor Object
    - Single or multiple DWH can be attached to a monitor
        - in that case, for multiple DWH - cumulative sum would be considered.
    - After limit is reached, we can notify or suspend DWH and notify.
    - Difference between suspend and suspend immediately.   
    - Show different Warehouse Monitor Object cases by creating them using SQL and discuss the important parameters.
